<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unlock Exclusive Content</title>
</head>
<body>

<div class="container">
    <div class="lock-icon">ðŸ”’</div>
    <p class="instructions">
        1. Click **Watch & Follow to Get Content**.<br>
        2. Follow the channel and **watch for at least 25 seconds**.<br>
        3. Return to unlock the content.
    </p>

    <button id="watchButton" class="button watch-button">Watch & Follow to Get Content</button>
    <button id="unlockButton" class="button unlock-button" disabled>ðŸ”“ Unlock Content</button>
</div>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const videoKey = urlParams.get('id');

    if (!videoKey) {
        alert("Invalid link. Please use a correct URL.");
        throw new Error("Missing 'id' parameter");
    }

    fetch("content.json")
        .then(response => response.json())
        .then(data => {
            if (!data[videoKey]) {
                alert("Content not found.");
                throw new Error("Invalid video key");
            }

            const entry = data[videoKey][0]; // Fetch corresponding content
            const videoId = entry.videoId; // Same video for different keys
            const contentLink = entry.contentLink;
            const youtubeUrl = `https://www.youtube.com/watch?v=${videoId}`;

            let watchButton = document.getElementById("watchButton");
            let unlockButton = document.getElementById("unlockButton");
            let timerStarted = false;

            watchButton.addEventListener("click", function () {
                window.open(youtubeUrl, "_blank");
                
                if (!timerStarted) {
                    timerStarted = true;
                    watchButton.textContent = "Watching...";

                    setTimeout(() => {
                        unlockButton.removeAttribute("disabled");
                    }, 25000); // Unlocks after 25 seconds
                }
            });

            unlockButton.addEventListener("click", function () {
                if (!unlockButton.hasAttribute("disabled")) {
                    window.location.href = contentLink;
                }
            });
        })
        .catch(error => console.error(error));
</script>

</body>
</html>
